<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Python Custom Formatting | Home</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <meta name="description" content="This blog post explains how to use Python&#39;s formatting mini-language to format strings and datetimes, as well as how to create custom formatting options for any object. It also provides an implementation for formatting geographic coordinates in various formats with different symbol options.">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/assets/css/0.styles.9da1fb00.css" as="style"><link rel="preload" href="/assets/js/app.dee1957a.js" as="script"><link rel="preload" href="/assets/js/2.d570518b.js" as="script"><link rel="preload" href="/assets/js/13.072270dc.js" as="script"><link rel="prefetch" href="/assets/js/10.648f5dcd.js"><link rel="prefetch" href="/assets/js/11.11a904b2.js"><link rel="prefetch" href="/assets/js/12.5719c188.js"><link rel="prefetch" href="/assets/js/14.94c5b22c.js"><link rel="prefetch" href="/assets/js/3.a9de7b62.js"><link rel="prefetch" href="/assets/js/4.b6ca103b.js"><link rel="prefetch" href="/assets/js/5.4b6b24ec.js"><link rel="prefetch" href="/assets/js/6.9b8c7518.js"><link rel="prefetch" href="/assets/js/7.80ca5fe1.js"><link rel="prefetch" href="/assets/js/8.8a578eb5.js"><link rel="prefetch" href="/assets/js/9.ba049e2b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9da1fb00.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Home</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/all_posts/" class="nav-link">
  Blogs
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/all_posts/" class="nav-link">
  Blogs
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Python Custom Formatting</span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="python-custom-formatting"><a href="#python-custom-formatting" class="header-anchor">#</a> Python Custom Formatting</h1> <p>Python f-strings use a formatting mini-language, the same as the older .format() function. After the colon comes short specifications for how to format the value:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> word <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>word<span class="token punctuation">:</span><span class="token format-spec">/^20</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
<span class="token string">'///////Hello////////'</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> amt <span class="token operator">=</span> <span class="token number">12345678</span>
<span class="token operator">&gt;&gt;</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>amt<span class="token punctuation">:</span><span class="token format-spec">20,</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
<span class="token string">'          12,345,678'</span>
</code></pre></div><p>Datetimes can use strftime syntax:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>now<span class="token punctuation">:</span><span class="token format-spec">%Y-%m on day %d</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
<span class="token string">'2022-04 on day 14'</span>
</code></pre></div><p>The reason datetime uses different formatting specs than strings is because datetime defines its own format method. Any object can define its own formatting mini-language. F-strings and .format() will use the format method on an object, and pass it the formatting directives being used:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">class</span> <span class="token class-name">Confused</span><span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token keyword">def</span> <span class="token function">__format__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fmt<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>         <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;What is </span><span class="token interpolation"><span class="token punctuation">{</span>fmt<span class="token punctuation">}</span></span><span class="token string">?&quot;</span></span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> c <span class="token operator">=</span> Confused<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>c<span class="token punctuation">:</span><span class="token format-spec">xyz12</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
<span class="token string">'What is xyz12?'</span>
</code></pre></div><p>Of course, format can be used for more useful formatting than Confused is doing...</p> <p>Geographic latitude and longitude are conventionally presented in a few different formats: degrees; or degrees and minutes; or degrees, minutes and seconds. Then the numbers can have varying number of decimal places, and sometimes the units are represented by symbols.</p> <p>Here’s an implementation of those possibilities in format. The format string starts with “d”, “dm”, or “dms” to indicate the basic format. The number of decimal places can be specified with “.N”. Finally, symbols can be added, either plain or fancy, by adding a quote or minute symbol:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> dataclasses<span class="token punctuation">,</span> re

<span class="token decorator annotation punctuation">@dataclasses<span class="token punctuation">.</span>dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">LatLong</span><span class="token punctuation">:</span>
    lat<span class="token punctuation">:</span> <span class="token builtin">float</span>
    <span class="token builtin">long</span><span class="token punctuation">:</span> <span class="token builtin">float</span>

    <span class="token keyword">def</span> <span class="token function">__format__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fmt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        dms<span class="token punctuation">,</span> nfmt<span class="token punctuation">,</span> opts <span class="token operator">=</span> re<span class="token punctuation">.</span>fullmatch<span class="token punctuation">(</span><span class="token string">r&quot;(dm?s?)([.\d]*)([′']?)&quot;</span><span class="token punctuation">,</span> fmt<span class="token punctuation">)</span><span class="token punctuation">.</span>groups<span class="token punctuation">(</span><span class="token punctuation">)</span>
        formatted <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> num <span class="token keyword">in</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> self<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            parts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> ms <span class="token keyword">in</span> dms<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                parts<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                num <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span>
            parts<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> nfmt <span class="token operator">+</span> <span class="token string">&quot;f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            syms <span class="token operator">=</span> <span class="token boolean">None</span>
            <span class="token keyword">if</span> <span class="token string">&quot;'&quot;</span> <span class="token keyword">in</span> opts<span class="token punctuation">:</span>
                syms <span class="token operator">=</span> <span class="token string">&quot;°'\&quot;&quot;</span>
            <span class="token keyword">elif</span> <span class="token string">&quot;′&quot;</span> <span class="token keyword">in</span> opts<span class="token punctuation">:</span>
                syms <span class="token operator">=</span> <span class="token string">&quot;°′″&quot;</span>
            <span class="token keyword">if</span> opts<span class="token punctuation">:</span>
                parts <span class="token operator">=</span> <span class="token punctuation">[</span>p <span class="token operator">+</span> s <span class="token keyword">for</span> p<span class="token punctuation">,</span> s <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>parts<span class="token punctuation">,</span> syms<span class="token punctuation">)</span><span class="token punctuation">]</span>
            formatted<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>parts<span class="token punctuation">)</span><span class="token punctuation">)</span>
        joined <span class="token operator">=</span> <span class="token string">&quot;, &quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>formatted<span class="token punctuation">)</span>
        <span class="token keyword">return</span> joined
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> where <span class="token operator">=</span> LatLong<span class="token punctuation">(</span><span class="token number">42.359764937</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">71.092068768</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Location: </span><span class="token interpolation"><span class="token punctuation">{</span>where<span class="token punctuation">:</span><span class="token format-spec">d'</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
Location<span class="token punctuation">:</span> <span class="token number">42.359765</span>°<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">71.092069</span>°
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Location: </span><span class="token interpolation"><span class="token punctuation">{</span>where<span class="token punctuation">:</span><span class="token format-spec">d.4</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
Location<span class="token punctuation">:</span> <span class="token number">42.3598</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">71.0921</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Location: </span><span class="token interpolation"><span class="token punctuation">{</span>where<span class="token punctuation">:</span><span class="token format-spec">dm'</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
Location<span class="token punctuation">:</span> <span class="token number">42</span>° <span class="token number">21.585896</span><span class="token string">', -71° 5.524126'</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Location: </span><span class="token interpolation"><span class="token punctuation">{</span>where<span class="token punctuation">:</span><span class="token format-spec">dms.4'</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
Location<span class="token punctuation">:</span> <span class="token number">42</span>° <span class="token number">21</span><span class="token string">' 35.1538&quot;, -71° 5'</span> <span class="token number">31.4476</span>&quot;
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Location: </span><span class="token interpolation"><span class="token punctuation">{</span>where<span class="token punctuation">:</span><span class="token format-spec">dms.4</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
Location<span class="token punctuation">:</span> <span class="token number">42</span> <span class="token number">21</span> <span class="token number">35.1538</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">71</span> <span class="token number">5</span> <span class="token number">31.4476</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Location: </span><span class="token interpolation"><span class="token punctuation">{</span>where<span class="token punctuation">:</span><span class="token format-spec">dms.6′</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
Location<span class="token punctuation">:</span> <span class="token number">42</span>° <span class="token number">21</span>′ <span class="token number">35.153773</span>″<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">71</span>° <span class="token number">5</span>′ <span class="token number">31.447565</span>″
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;There: {:dms.6′}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span><span class="token punctuation">)</span>
There<span class="token punctuation">:</span> <span class="token number">42</span>° <span class="token number">21</span>′ <span class="token number">35.153773</span>″<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">71</span>° <span class="token number">5</span>′ <span class="token number">31.447565</span>″
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">format</span><span class="token punctuation">(</span>where<span class="token punctuation">,</span> <span class="token string">&quot;dms.6′&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">42</span>° <span class="token number">21</span>′ <span class="token number">35.153773</span>″<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">71</span>° <span class="token number">5</span>′ <span class="token number">31.447565</span>″
</code></pre></div><p>This implementation doesn’t handle errors properly, but shows the basic idea. Also, lat/long are often shown with N/S E/W instead of positive and negative values. That’s left as an exercise for the reader.</p> <div style="text-align:right;font-size:xx-small;"> Published date: 21 April, 2023 </div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dee1957a.js" defer></script><script src="/assets/js/2.d570518b.js" defer></script><script src="/assets/js/13.072270dc.js" defer></script>
  </body>
</html>
